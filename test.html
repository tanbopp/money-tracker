<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Money Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Test Money Tracker Features</h1>
        
        <div class="grid md:grid-cols-2 gap-6">
            <!-- Test Data Generation -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4">Generate Test Data</h2>
                <p class="text-gray-600 mb-4">Klik tombol di bawah untuk mengisi aplikasi dengan data contoh</p>
                <button onclick="generateTestData()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Generate Test Data
                </button>
            </div>

            <!-- Feature Checklist -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4">Features to Test</h2>
                <ul class="space-y-2 text-sm">
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Dashboard balance calculation
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Add income/expense transactions
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Transaction history filtering
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Daily limit warnings
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Statistics charts rendering
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Goals creation and progress
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Savings deposit/withdraw
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> AI Chat natural language processing
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Auto transaction detection
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Indonesian number format parsing
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Category auto-detection
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> IDR currency formatting
                    </li>
                    <li class="flex items-center">
                        <input type="checkbox" class="mr-2"> Responsive design
                    </li>
                </ul>
            </div>
        </div>

        <!-- AI Chat Test -->
        <div class="mt-6 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Test AI Chat</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <h3 class="font-medium mb-2">Test Messages</h3>
                    <div class="space-y-2">
                        <button onclick="testAIMessage('beli bakso 25rb')" class="block w-full text-left p-2 bg-gray-100 hover:bg-gray-200 rounded text-sm">
                            "beli bakso 25rb"
                        </button>
                        <button onclick="testAIMessage('mau nabung 50 ribu')" class="block w-full text-left p-2 bg-gray-100 hover:bg-gray-200 rounded text-sm">
                            "mau nabung 50 ribu"
                        </button>
                        <button onclick="testAIMessage('dapat gaji 5 juta')" class="block w-full text-left p-2 bg-gray-100 hover:bg-gray-200 rounded text-sm">
                            "dapat gaji 5 juta"
                        </button>
                        <button onclick="testAIMessage('bayar listrik 150rb')" class="block w-full text-left p-2 bg-gray-100 hover:bg-gray-200 rounded text-sm">
                            "bayar listrik 150rb"
                        </button>
                    </div>
                </div>
                <div>
                    <h3 class="font-medium mb-2">AI Test Results</h3>
                    <div id="aiTestResults" class="text-sm text-gray-600 p-3 bg-gray-50 rounded min-h-[150px]">
                        Click test messages to see AI parsing results
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Results -->
        <div class="mt-6 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Test Results</h2>
            <div id="testResults" class="text-gray-600">
                Click "Generate Test Data" to see results here
            </div>
        </div>

        <!-- Back to Main App -->
        <div class="mt-6 text-center">
            <a href="index.html" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 inline-block">
                Back to Money Tracker
            </a>
        </div>
    </div>

    <script>
        function generateTestData() {
            const testResults = document.getElementById('testResults');
            
            // Sample transactions
            const sampleTransactions = [
                {
                    id: Date.now() + 1,
                    type: 'income',
                    amount: 5000000,
                    category: 'Gaji',
                    description: 'Gaji bulan ini',
                    date: new Date().toISOString()
                },
                {
                    id: Date.now() + 2,
                    type: 'expense',
                    amount: 150000,
                    category: 'Makanan',
                    description: 'Makan siang',
                    date: new Date(Date.now() - 86400000).toISOString()
                },
                {
                    id: Date.now() + 3,
                    type: 'expense',
                    amount: 50000,
                    category: 'Transportasi',
                    description: 'Bensin motor',
                    date: new Date(Date.now() - 172800000).toISOString()
                },
                {
                    id: Date.now() + 4,
                    type: 'income',
                    amount: 500000,
                    category: 'Freelance',
                    description: 'Project website',
                    date: new Date(Date.now() - 259200000).toISOString()
                },
                {
                    id: Date.now() + 5,
                    type: 'expense',
                    amount: 200000,
                    category: 'Belanja',
                    description: 'Belanja bulanan',
                    date: new Date(Date.now() - 345600000).toISOString()
                }
            ];

            // Sample goals
            const sampleGoals = [
                {
                    id: Date.now() + 10,
                    name: 'Emergency Fund',
                    targetAmount: 10000000,
                    currentAmount: 2500000,
                    targetDate: '2024-12-31'
                },
                {
                    id: Date.now() + 11,
                    name: 'Laptop Baru',
                    targetAmount: 15000000,
                    currentAmount: 5000000,
                    targetDate: '2024-08-15'
                }
            ];

            // Sample savings history
            const sampleSavings = [
                {
                    id: Date.now() + 20,
                    type: 'deposit',
                    amount: 1000000,
                    description: 'Tabungan rutin',
                    date: new Date().toISOString()
                },
                {
                    id: Date.now() + 21,
                    type: 'deposit',
                    amount: 500000,
                    description: 'Bonus project',
                    date: new Date(Date.now() - 604800000).toISOString()
                }
            ];

            // Daily limit settings
            const dailyLimitSettings = {
                enabled: true,
                amount: 300000,
                resetTime: 'midnight',
                warningEnabled: true,
                warning50: true,
                warning75: true,
                warning90: true,
                blockOverLimit: false
            };

            try {
                // Store test data
                localStorage.setItem('transactions', JSON.stringify(sampleTransactions));
                localStorage.setItem('goals', JSON.stringify(sampleGoals));
                localStorage.setItem('savingsHistory', JSON.stringify(sampleSavings));
                localStorage.setItem('savingsBalance', '1500000');
                localStorage.setItem('dailyLimitSettings', JSON.stringify(dailyLimitSettings));

                // Display results
                const totalIncome = sampleTransactions
                    .filter(t => t.type === 'income')
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const totalExpense = sampleTransactions
                    .filter(t => t.type === 'expense')
                    .reduce((sum, t) => sum + t.amount, 0);

                const balance = totalIncome - totalExpense;

                testResults.innerHTML = `
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-green-50 p-4 rounded">
                            <h3 class="font-semibold text-green-700">Test Data Generated</h3>
                            <p class="text-sm text-green-600">
                                ${sampleTransactions.length} transactions<br>
                                ${sampleGoals.length} goals<br>
                                ${sampleSavings.length} savings entries
                            </p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded">
                            <h3 class="font-semibold text-blue-700">Financial Summary</h3>
                            <p class="text-sm text-blue-600">
                                Balance: ${formatCurrency(balance)}<br>
                                Income: ${formatCurrency(totalIncome)}<br>
                                Expense: ${formatCurrency(totalExpense)}
                            </p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded">
                            <h3 class="font-semibold text-purple-700">Settings</h3>
                            <p class="text-sm text-purple-600">
                                Daily Limit: ${formatCurrency(dailyLimitSettings.amount)}<br>
                                Savings: ${formatCurrency(1500000)}<br>
                                Warnings: Enabled
                            </p>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-green-100 rounded-lg">
                        <p class="text-green-700 font-semibold">✅ Test data berhasil di-generate!</p>
                        <p class="text-green-600 text-sm mt-1">
                            Silakan kembali ke aplikasi utama untuk menguji semua fitur dengan data yang telah dibuat.
                        </p>
                    </div>
                `;

            } catch (error) {
                testResults.innerHTML = `
                    <div class="p-4 bg-red-100 rounded-lg">
                        <p class="text-red-700 font-semibold">❌ Error generating test data:</p>
                        <p class="text-red-600 text-sm">${error.message}</p>
                    </div>
                `;
            }
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        // Simple AI testing (minimal version for testing)
        function testAIMessage(message) {
            const resultsDiv = document.getElementById('aiTestResults');
            
            // Simple pattern matching for testing
            const amount = extractAmount(message);
            const type = detectType(message);
            const category = detectCategory(message, type);
            
            resultsDiv.innerHTML = `
                <div class="space-y-2">
                    <div><strong>Input:</strong> "${message}"</div>
                    <div><strong>Detected Amount:</strong> ${formatCurrency(amount)}</div>
                    <div><strong>Detected Type:</strong> ${type}</div>
                    <div><strong>Detected Category:</strong> ${category}</div>
                    <div class="mt-3 p-2 ${amount > 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'} rounded">
                        ${amount > 0 ? '✅ Successfully parsed!' : '❌ Failed to parse amount'}
                    </div>
                </div>
            `;
        }

        function extractAmount(message) {
            const text = message.toLowerCase();
            
            // Pattern for Indonesian number formats
            const patterns = [
                /(\d+)\s*rb/,
                /(\d+)\s*ribu/,
                /(\d+)\s*jt/,
                /(\d+)\s*juta/,
                /(\d+)/
            ];

            const multipliers = {
                'rb': 1000,
                'ribu': 1000,
                'jt': 1000000,
                'juta': 1000000
            };

            for (const pattern of patterns) {
                const match = text.match(pattern);
                if (match) {
                    const number = parseInt(match[1]);
                    const suffix = text.match(/\d+\s*(rb|ribu|jt|juta)/);
                    if (suffix) {
                        return number * (multipliers[suffix[1]] || 1);
                    }
                    return number;
                }
            }
            return 0;
        }

        function detectType(message) {
            const text = message.toLowerCase();
            
            if (text.includes('nabung') || text.includes('menabung')) {
                return 'savings';
            }
            if (text.includes('gaji') || text.includes('dapat') || text.includes('terima')) {
                return 'income';
            }
            return 'expense';
        }

        function detectCategory(message, type) {
            const text = message.toLowerCase();
            
            if (type === 'expense') {
                if (text.includes('makan') || text.includes('bakso') || text.includes('nasi')) return 'Makanan';
                if (text.includes('listrik') || text.includes('air') || text.includes('internet')) return 'Tagihan';
                if (text.includes('bensin') || text.includes('ojek') || text.includes('transport')) return 'Transportasi';
                return 'Lainnya';
            } else if (type === 'income') {
                if (text.includes('gaji')) return 'Gaji';
                return 'Lainnya';
            }
            return 'Lainnya';
        }
    </script>
</body>
</html>
